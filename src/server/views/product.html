{% extends '_base.html' %}

{% block title %}{% endblock %}


{% block content %}

<section class="standard-section" id="product">
  <div class="container">
    <div class="row">
      <div class="col-md-2"></div>
      <div class="col-md-8">
        <div class="jumbotron" id="product-item">
          <h1>{{product.name}}</h1>
          <p class="lead">${{product.amount}}</p>
          <a href="/products">Back to product list</a>
          <img src="{{ baseurl }}/img/joyfulNoise.png" alt="joyfulNoise">
          <br>
          <br>
          {% if user %}

            <a class="btn btn-primary" id="customButton"  role="button">Buy Now</a>

          {% else %}
            <h3>Please <a href="/auth/login">log in</a> to Purchase!</h3>
          {% endif %}
        </div>
      </div>
      <div class="col-md-2"></div>
    </div>
  </div>
</section>

<script src="https://checkout.stripe.com/checkout.js"></script>

<script>
  var handler = StripeCheckout.configure({
    key: 'pk_test_LBAIutNdUcENELbP79ZG5yVI',
    image: '/img/mtm_logo.svg',
    locale: 'auto',
    shippingAddress: 'true',
    token: function(token) {
      // Use the token to create the charge with a server-side script.
      // You can access the token ID with `token.id`
    }
  });

  $('#customButton').on('click', function(e) {
    // Open Checkout with further options
    handler.open({
      name: 'Stripe.com',
      description: '2 widgets',
      amount: 2000
    });
    e.preventDefault();
  });

  // Close Checkout on page navigation
  $(window).on('popstate', function() {
    handler.close();
  });
</script>

{% endblock %}